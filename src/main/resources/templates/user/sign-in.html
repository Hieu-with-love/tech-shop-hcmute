<!doctype html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
    <title>Tech Shop || Sign in</title>
    <div th:insert="~{user/fragments/head :: head}"></div>
</head>
<body>
    <div class="axil-signin-area">

        <!-- Start Header -->
        <div class="signin-header">
            <div class="row align-items-center">
                <div class="col-sm-4">
                    <a th:href="@{/user}" class="site-logo"><img th:src="@{/user/assets/images/logo/logo.png}" alt="logo"></a>
                </div>
                <div class="col-sm-8">
                    <div class="singin-header-btn">
                        <p>Not a member?</p>
                        <a th:href="@{/register}" class="axil-btn btn-bg-secondary sign-up-btn">Sign Up Now</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Header -->

        <div class="row">
            <div class="col-xl-4 col-lg-6">
                <div class="axil-signin-banner bg_image bg_image--9">
                    <h3 class="title">We Offer the Best Products</h3>
                </div>
            </div>
            <div class="col-lg-6 offset-xl-2">
                <div class="axil-signin-form-wrap">
                    <div class="axil-signin-form">
                        <span id="message" class="error-msg"></span>
                        <h3 class="title">Sign in to Tech Shop.</h3>
                        <p class="b2 mb--55">Enter your detail below</p>
                        <form id="loginForm" class="singin-form">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" class="form-control" id="username" name="username"
                                       placeholder="Enter email">
                            </div>
                            <div class="form-group">
                                <label>Password</label>
                                <input type="password" class="form-control" id="password" name="password"
                                       placeholder="Enter password">
                            </div>
                            <div class="form-group d-flex align-items-center justify-content-between">
                                <button type="submit" class="axil-btn btn-bg-primary submit-btn">Sign In</button>
                                <a th:href="@{/forgot-password}" class="forgot-btn">Forget password?</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="~{/user/fragments/script::script}"></div>
<script src="/webjars/jquery/3.7.1/jquery.min.js"></script>
    <script>
        $('#loginForm').on('submit', function(event) {
            event.preventDefault(); // Ngăn form submit mặc định

            $.ajax({
                url: '/api/auth/log-in',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    username: $('#username').val(),
                    password: $('#password').val()
                }),
                success: function(response) {
                    // Lưu token vào local storage hoặc session storage
                    localStorage.setItem('authToken', response.token);
                    window.location.href = "/user/home"
                    //$('#message').text('Đăng nhập thành công! ' + localStorage.getItem('authToken'));
                    // Chuyển hướng hoặc tiếp tục sử dụng token cho các yêu cầu tiếp theo
                },
                error: function() {
                    $('#message').text('Đăng nhập thất bại. Vui lòng thử lại!');
                }
            });
        });
    </script>

</body>
</html>